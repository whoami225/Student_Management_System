import java.sql.*;
import java.util.*;

public class AssignmentDAO {
    private Connection conn;

    public AssignmentDAO(Connection conn) {
        this.conn = conn;
    }

    public void addAssignment(Assignment a) throws SQLException {
        String sql = "INSERT INTO assignments (subject_id, title, description, upload_date, due_date, file_path) VALUES (?, ?, ?, ?, ?, ?)";
        PreparedStatement stmt = conn.prepareStatement(sql);
        stmt.setInt(1, a.getSubjectId());
        stmt.setString(2, a.getTitle());
        stmt.setString(3, a.getDescription());
        stmt.setString(4, a.getUploadDate());
        stmt.setString(5, a.getDueDate());
        stmt.setString(6, a.getFilePath());
        stmt.executeUpdate();
    }

    public List<Assignment> getAllAssignments() throws SQLException {
        List<Assignment> list = new ArrayList<>();
        String sql = "SELECT * FROM assignments";
        Statement stmt = conn.createStatement();
        ResultSet rs = stmt.executeQuery(sql);

        while (rs.next()) {
            Assignment a = new Assignment();
            a.setAssignmentId(rs.getInt("assignment_id"));
            a.setSubjectId(rs.getInt("subject_id"));
            a.setTitle(rs.getString("title"));
            a.setDescription(rs.getString("description"));
            a.setUploadDate(rs.getString("upload_date"));
            a.setDueDate(rs.getString("due_date"));
            a.setFilePath(rs.getString("file_path"));
            list.add(a);
        }

        return list;
    }
}
